!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var a in n)("object"==typeof exports?exports:e)[a]=n[a]}}(window,(function(){return function(e){function t(t){for(var a,c,s=t[0],i=t[1],l=t[2],f=0,m=[];f<s.length;f++)c=s[f],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&m.push(r[c][0]),r[c]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var i=n[s];0!==r[i]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={3:0},o=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var s=window.webpackJsonp=window.webpackJsonp||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=i;return o.push([20,0]),n()}({2:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subscriberList={}}var t,n;return t=e,(n=[{key:"subscribe",value:function(e,t){this.subscriberList[e]=t}},{key:"sendMessage",value:function(e,t){if(Array.isArray(e)||(e=[e]),"broadcast"===e[0])this.subscriberList.forEach((function(e,n){e({type:"broadcast",message:t})}));else for(var n in this.subscriberList)0<=e.indexOf(n)&&this.subscriberList[n](t)}}])&&a(t.prototype,n),e}());t.a=r},20:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),c=n.n(o),s=n(1),i=n(9),l=n(10),u=n(3),f=n(2),m=n(4);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=y(e);return a=this,!(r=t?(n=y(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==p(r)&&"function"!=typeof r?g(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,userList:e.userList,currentUser:e.currentUser,newUser:e.newUser,newUserScheme:e.newUserScheme,canContinue:e.canContinue,showGrant:e.showGrant,schemeListRequired:e.schemeListRequired,bGrantTitle:e.showGrant?s.a.t("login.grant-auth-title"):s.a.t("login.grant-change-title"),bGrant:e.showGrant?s.a.t("login.grant-auth"):s.a.t("login.grant-change"),showGrantAsterisk:e.showGrantAsterisk,selectAccount:e.selectAccount},t.clickLogout=t.clickLogout.bind(g(t)),t.clickGrant=t.clickGrant.bind(g(t)),t.clickContinue=t.clickContinue.bind(g(t)),t.newUser=t.newUser.bind(g(t)),t.managerUsers=t.managerUsers.bind(g(t)),t.changeSessionScheme=t.changeSessionScheme.bind(g(t)),t.registerNewUser=t.registerNewUser.bind(g(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({userList:e.userList,currentUser:e.currentUser,config:e.config,showGrant:e.showGrant,newUser:e.newUser,newUserScheme:e.newUserScheme,canContinue:e.canContinue,schemeListRequired:e.schemeListRequired,bGrantTitle:e.showGrant?s.a.t("login.grant-auth-title"):s.a.t("login.grant-change-title"),bGrant:e.showGrant?s.a.t("login.grant-auth"):s.a.t("login.grant-change"),showGrantAsterisk:e.showGrantAsterisk,selectAccount:e.selectAccount})}},{key:"clickLogout",value:function(){u.a.glewlwydRequest("/auth/?username="+this.state.currentUser.username,"DELETE").then((function(){f.a.sendMessage("App",{type:"InitProfile"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-delete-session")}),f.a.sendMessage("App",{type:"InitProfile"})}))}},{key:"clickGrant",value:function(){f.a.sendMessage("App",{type:"ToggleGrant"})}},{key:"clickContinue",value:function(){this.state.config.params.callback_url&&(document.location.href=this.state.config.params.callback_url+(0<this.state.config.params.callback_url.indexOf("?")?"&g_continue":"?g_continue"))}},{key:"newUser",value:function(e,t){e.preventDefault(),t?u.a.glewlwydRequest("/auth/","POST",{username:t}).then((function(){f.a.sendMessage("App",{type:"InitProfile"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})})):f.a.sendMessage("App",{type:"NewUser"})}},{key:"registerNewUser",value:function(e,t){e.preventDefault(),document.location.href=this.state.config.ProfileUrl+"?register="+encodeURIComponent(t)}},{key:"managerUsers",value:function(e){e.preventDefault(),f.a.sendMessage("App",{type:"SelectAccount"})}},{key:"changeSessionScheme",value:function(e,t){e.preventDefault(),f.a.sendMessage("App",{type:"newUserScheme",scheme:t})}},{key:"render",value:function(){var e=this,t="",n="",a="",o=[];if(this.state.canContinue&&(a=r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:this.clickContinue,title:s.a.t("login.continue-title")},r.a.createElement("i",{className:"fas fa-play btn-icon"}),s.a.t("login.continue"))),this.clickGrant,this.state.bGrantTitle,this.state.bGrant,this.state.showGrantAsterisk&&(n=r.a.createElement("small",null,r.a.createElement("i",{className:"fas fa-asterisk btn-icon-right"}))),this.state.currentUser&&!this.state.selectAccount){this.state.config.register&&this.state.config.register.forEach((function(t,n){o.push(r.a.createElement("a",{key:n,className:"dropdown-item",href:"#",onClick:function(n){return e.registerNewUser(n,t.name)}},s.a.t(t.message)))}));var c=[];return this.state.userList&&this.state.userList.forEach((function(t,n){e.state.currentUser.username===t.username?c.push(r.a.createElement("a",{className:"dropdown-item active",href:"#",onClick:function(n){return e.newUser(n,t.username)},key:n,alt:t.name||t.username},t.name||t.username)):c.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(n){return e.newUser(n,t.username)},key:n,alt:t.name||t.username},t.name||t.username))})),t=r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"selectNewUser","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-users btn-icon"}),s.a.t("login.login-another")),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectNewUser"},r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.newUser(t,!1)}},s.a.t("login.login-another-new")),r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(t){return e.managerUsers(t)}},s.a.t("login.manage-users")),o,r.a.createElement("div",{className:"dropdown-divider"}),c)),r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"btn-group",role:"group"},a,r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.clickLogout},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),s.a.t("login.logout"))),r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"selectGrant","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-user-cog btn-icon"}),s.a.t("login.login-handle"),n),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectGrant"},r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:this.clickGrant,alt:this.state.bGrantTitle},this.state.bGrant,n),r.a.createElement("div",{className:"dropdown-divider"}),r.a.createElement("a",{className:"dropdown-item",href:this.state.config.ProfileUrl||"",target:"_blank"},s.a.t("login.update-profile")))),t)))}if(this.state.newUser){this.state.config.register&&this.state.config.register.forEach((function(t,n){o.push(r.a.createElement("button",{key:n,type:"button",className:"btn btn-primary",onClick:function(n){return e.registerNewUser(n,t.name)}},s.a.t(t.message)))}));var i=[];return this.state.config.sessionSchemes&&this.state.config.sessionSchemes.length?(this.state.newUserScheme?i.push(r.a.createElement("a",{key:0,className:"dropdown-item",href:"#",onClick:function(t){return e.changeSessionScheme(t,!1)},alt:s.a.t("login.password-title")},s.a.t("login.password-title"))):i.push(r.a.createElement("a",{key:0,className:"dropdown-item active",href:"#",onClick:function(t){return e.changeSessionScheme(t,!1)},alt:s.a.t("login.password-title")},s.a.t("login.password-title"))),i.push(r.a.createElement("div",{key:1,className:"dropdown-divider"})),this.state.config.sessionSchemes.forEach((function(t,n){!1!==t.show_nopassword_form&&(t.scheme_name===e.state.newUserScheme?i.push(r.a.createElement("a",{key:n+2,className:"dropdown-item active",href:"#",onClick:function(n){return e.changeSessionScheme(n,t.scheme_name)},alt:s.a.t(t.scheme_display_name)},s.a.t(t.scheme_display_name))):i.push(r.a.createElement("a",{key:n+2,className:"dropdown-item",href:"#",onClick:function(n){return e.changeSessionScheme(n,t.scheme_name)},alt:s.a.t(t.scheme_display_name)},s.a.t(t.scheme_display_name))))})),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectScheme","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-user-lock btn-icon"}),s.a.t("login.login-choose-scheme")),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectScheme"},i)),o)):r.a.createElement("div",null,o)}return""}}])&&h(e.prototype,t),o}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=N(e);return a=this,!(r=t?(n=N(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==v(r)&&"function"!=typeof r?S(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,show:e.show,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable},t.handleToggleGrantScope=t.handleToggleGrantScope.bind(S(t)),t.handleGrantScope=t.handleGrantScope.bind(S(t)),f.a.subscribe("GrantScope",(function(e){})),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,show:e.show,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable})}},{key:"handleToggleGrantScope",value:function(e){var t=this.state.scope;t.forEach((function(t){t.name===e.name&&(t.granted=!t.granted)})),this.setState({scope:t})}},{key:"handleGrantScope",value:function(){var e=[];this.state.scope.forEach((function(t){t.granted&&e.push(t.name)})),u.a.glewlwydRequest("/auth/grant/"+encodeURIComponent(this.state.client.client_id),"PUT",{scope:e.join(" ")}).then((function(){f.a.sendMessage("App",{type:"GrantComplete"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-set-grant")})}))}},{key:"render",value:function(){var e,t=this,n=[];return this.state.scope.forEach((function(e,a){"openid"===e.name?n.push(r.a.createElement("li",{className:"list-group-item",key:a},r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",checked:!0,disabled:!0}),r.a.createElement("label",{className:"form-check-label",htmlFor:"grant-"+e.name},e.display_name)))):n.push(r.a.createElement("li",{className:"list-group-item",key:a},r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",onChange:function(){return t.handleToggleGrantScope(e)},id:"grant-"+e.name,checked:e.granted}),r.a.createElement("label",{className:"form-check-label",htmlFor:"grant-"+e.name},e.display_name))))})),this.state.infoSomeScopeUnavailable&&(e=r.a.createElement("div",{className:"alert alert-info",role:"alert"},s.a.t("login.info-some-scope-unavailable"))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h5",null,s.a.t("login.grant-title",{client:this.state.client.name})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("ul",{className:"list-group"},n))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},e)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleGrantScope},s.a.t("login.grant")))),r.a.createElement("hr",{className:"glwd-hr-no-border"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("b",null,s.a.t("login.grant-info-message")))))}}])&&w(e.prototype,t),o}();function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=R(e);return a=this,!(r=t?(n=R(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==k(r)&&"function"!=typeof r?P(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,triggerResult:!1,mockValue:""},t.triggerScheme=t.triggerScheme.bind(P(t)),t.validateMockValue=t.validateMockValue.bind(P(t)),t.handleChangeMockValue=t.handleChangeMockValue.bind(P(t)),t.triggerScheme(),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser,triggerResult:!1,mockValue:""},(function(){t.triggerScheme()}))}},{key:"triggerScheme",value:function(){var e,t=this;this.state.scheme&&this.state.currentUser&&(e={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{description:"This is a mock trigger"}},u.a.glewlwydRequest("/auth/scheme/trigger/","POST",e,!0).then((function(e){t.setState({triggerResult:e.code})})).fail((function(e){401===e.status?f.a.sendMessage("Notification",{type:"info",message:s.a.t("login.mock-trigger-must-register")}):f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-mock-trigger")})})))}},{key:"handleChangeMockValue",value:function(e){this.setState({mockValue:e.target.value})}},{key:"validateMockValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{code:this.state.mockValue}};u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("App",{type:"loginSuccess",loginSuccess:!0})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-mock-value")})}))}},{key:"render",value:function(){var e=this;return this.state.triggerResult?r.a.createElement("form",{action:"#",id:"mockSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.enter-mock-scheme-value"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"mockValue"},s.a.t("login.mock-value-label"))),r.a.createElement("input",{type:"text",className:"form-control",name:"mockValue",id:"mockValue",autoFocus:!0,required:"",placeholder:s.a.t("login.error-mock-expected",{value:this.state.triggerResult}),value:this.state.mockValue||"",onChange:this.handleChangeMockValue,autoComplete:"false"}))),r.a.createElement("button",{type:"submit",name:"mockbut",id:"mockbut",className:"btn btn-primary",onClick:function(t){return e.validateMockValue(t)},title:s.a.t("login.mock-value-button-title")},s.a.t("login.btn-ok"))):r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.triggerScheme},s.a.t("login.btn-reload"))}}])&&U(e.prototype,t),o}();function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=L(e);return a=this,!(r=t?(n=L(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==j(r)&&"function"!=typeof r?T(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,code:"",showValidate:!1},t.triggerScheme=t.triggerScheme.bind(T(t)),t.validateCode=t.validateCode.bind(T(t)),t.handleChangeCode=t.handleChangeCode.bind(T(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser,code:"",showValidate:!1})}},{key:"triggerScheme",value:function(e){var t,n=this;e.preventDefault(),this.state.scheme&&this.state.currentUser&&(t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}},u.a.glewlwydRequest("/auth/scheme/trigger/","POST",t).then((function(e){f.a.sendMessage("Notification",{type:"info",message:s.a.t("login.mail-trigger-ok")}),n.setState({showValidate:!0})})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.mail-trigger-error")})})))}},{key:"handleChangeCode",value:function(e){this.setState({code:e.target.value})}},{key:"validateCode",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{code:this.state.code}};u.a.glewlwydRequest("/auth/","POST",t,!0).then((function(){f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(e){401===e.status?f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.mail-code-invalid")}):f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.mail-code-error")})}))}},{key:"render",value:function(){var e,t,n=this;return this.state.showValidate&&(e=r.a.createElement("button",{type:"submit",name:"mailbut",id:"mailbut",className:"btn btn-primary",onClick:function(e){return n.validateCode(e)},title:s.a.t("login.mail-code-button-title")},s.a.t("login.btn-ok")),t=r.a.createElement("input",{type:"text",className:"form-control",name:"code",id:"code",autoFocus:!0,required:"",placeholder:s.a.t("login.mail-code-ph"),value:this.state.code||"",onChange:this.handleChangeCode,autoComplete:"false"})),r.a.createElement("form",{action:"#",id:"mailSchemeForm",onSubmit:function(e){return n.validateCode(e)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.mail-enter-scheme-code"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"code"},s.a.t("login.mail-code-label"))),t)),r.a.createElement("div",{className:"btn-group",role:"group"},e,r.a.createElement("button",{type:"button",name:"triggerbut",id:"triggerbut",className:"btn btn-primary",onClick:this.triggerScheme,title:s.a.t("login.mail-trigger-button-title")},s.a.t("login.mail-scheme-trigger"))))}}])&&A(e.prototype,t),o}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=I(e);return a=this,!(r=t?(n=I(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==M(r)&&"function"!=typeof r?V(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,canLogin:!1,webauthnEnabled:!!window.PublicKeyCredential},t.triggerScheme=t.triggerScheme.bind(V(t)),t.login=t.login.bind(V(t)),t.triggerScheme(),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser},(function(){t.triggerScheme()}))}},{key:"strToBin",value:function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}},{key:"binToStr",value:function(e){return btoa(new Uint8Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),""))}},{key:"login",value:function(){var e=this;u.a.glewlwydRequest("/auth/scheme/trigger/","POST",{username:this.state.currentUser.username,scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,value:{}}).then((function(t){var n=[];t.allowCredentials.forEach((function(t){n.push({id:e.strToBin(t.credential_id),type:"public-key"})}));var a={allowCredentials:n,challenge:e.strToBin(t.challenge)};navigator.credentials.get({publicKey:a}).then((function(n){var a={};"id"in n&&(a.id=n.id),"type"in n&&(a.type=n.type),"rawId"in n&&(a.rawId=e.binToStr(n.rawId)),a.response={clientDataJSON:e.binToStr(n.response.clientDataJSON),authenticatorData:e.binToStr(n.response.authenticatorData),signature:e.binToStr(n.response.signature),userHandle:e.binToStr(n.response.userHandle)},n.response.getTransports&&(response.transports=n.response.getTransports()),u.a.glewlwydRequest("/auth/","POST",{username:e.state.currentUser.username,scheme_type:e.state.scheme.scheme_type,scheme_name:e.state.scheme.scheme_name,value:{session:t.session,credential:a}}).then((function(){f.a.sendMessage("App",{type:"loginSuccess"}),f.a.sendMessage("Notification",{type:"info",message:s.a.t("profile.scheme-webauthn-assertion-success")})})).fail((function(e){401===e.status?f.a.sendMessage("Notification",{type:"danger",message:s.a.t("profile.scheme-webauthn-assertion-error")}):f.a.sendMessage("Notification",{type:"danger",message:s.a.t("error-api-connect")})}))})).catch((function(e){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("profile.scheme-webauthn-error-assertion")})}))})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("error-api-connect")})}))}},{key:"triggerScheme",value:function(){var e,t=this;this.state.scheme&&this.state.currentUser&&(e={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}},u.a.glewlwydRequest("/auth/scheme/trigger/","POST",e).then((function(e){t.setState({canLogin:!0})})).fail((function(e){t.setState({canLogin:!1},(function(){401===e.status?f.a.sendMessage("Notification",{type:"info",message:s.a.t("login.webauthn-trigger-must-register")}):f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.webauthn-error-trigger")})}))})))}},{key:"render",value:function(){var e,t=this;return this.state.webauthnEnabled||(e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},s.a.t("profile.scheme-webauthn-disabled"))))),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.webauthn-login-title"))),r.a.createElement("div",{className:"form-group"},e),r.a.createElement("button",{type:"button",name:"loginBut",id:"loginBut",disabled:!this.state.canLogin||!this.state.webauthnEnabled,className:"btn btn-primary",onClick:function(e){return t.login(e)},title:s.a.t("login.webauthn-login-button-title")},s.a.t("login.webauthn-login-authenticate")))}}])&&q(e.prototype,t),o}();function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=K(e);return a=this,!(r=t?(n=K(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==W(r)&&"function"!=typeof r?z(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,value:""},t.validateOTPValue=t.validateOTPValue.bind(z(t)),t.handleChangeOTPValue=t.handleChangeOTPValue.bind(z(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"handleChangeOTPValue",value:function(e){this.setState({value:e.target.value})}},{key:"validateOTPValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{value:this.state.value}};u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("Notification",{type:"info",message:s.a.t("login.success-login")}),f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{action:"#",id:"otpSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.otp-enter-value"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"value"},s.a.t("login.otp-value-label"))),r.a.createElement("input",{type:"text",className:"form-control",name:"value",id:"value",required:"",placeholder:s.a.t("login.error-value-expected",{value:this.state.triggerResult}),value:this.state.value||"",onChange:this.handleChangeOTPValue,autoFocus:!0,autoComplete:"false"}))),r.a.createElement("button",{type:"submit",name:"but",id:"but",className:"btn btn-primary",onClick:function(t){return e.validateOTPValue(t)},title:s.a.t("login.otp-button-title")},s.a.t("login.btn-ok")))}}])&&B(e.prototype,t),o}();function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var te=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=ee(e);return a=this,!(r=t?(n=ee(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==Q(r)&&"function"!=typeof r?Z(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,value:""},t.validatePasswordValue=t.validatePasswordValue.bind(Z(t)),t.handleChangePasswordValue=t.handleChangePasswordValue.bind(Z(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"handleChangePasswordValue",value:function(e){this.setState({value:e.target.value})}},{key:"validatePasswordValue",value:function(e){e.preventDefault();var t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{password:this.state.value}};u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("Notification",{type:"info",message:s.a.t("login.success-login")}),f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{action:"#",id:"otpSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.password-enter-value"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"value"},s.a.t("login.password-value-label"))),r.a.createElement("input",{type:"password",className:"form-control",name:"value",id:"value",required:"",placeholder:s.a.t("login.error-value-expected",{value:this.state.triggerResult}),value:this.state.value||"",onChange:this.handleChangePasswordValue,autoFocus:!0}))),r.a.createElement("button",{type:"submit",name:"but",id:"but",className:"btn btn-primary",onClick:function(t){return e.validatePasswordValue(t)},title:s.a.t("login.password-button-title")},s.a.t("login.btn-ok")))}}])&&Y(e.prototype,t),o}();function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=ce(e);return a=this,!(r=t?(n=ce(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==ne(r)&&"function"!=typeof r?oe(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,authResult:!1,authValidated:!1},t.validateCertificate=t.validateCertificate.bind(oe(t)),t}return e=o,(t=[{key:"validateCertificate",value:function(){var e,t=this;this.state.authResult||(e={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{}},u.a.glewlwydRequest("/auth/","POST",e).then((function(){t.setState({authResult:!0,authValidated:!0},(function(){f.a.sendMessage("App",{type:"loginSuccess",loginSuccess:!0})}))})).fail((function(){t.setState({authResult:!1,authValidated:!0})})))}},{key:"render",value:function(){var e,t,n=this;return!0===this.state.authResult?e=r.a.createElement("div",{className:"alert alert-success",role:"alert"},s.a.t("login.certificate-scheme-auth-success")):!1===this.state.authResult&&(this.state.authValidated&&(t=r.a.createElement("div",{className:"alert alert-danger",role:"alert"},s.a.t("login.certificate-scheme-auth-invalid"))),e=r.a.createElement("div",null,t,r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return n.validateCertificate()}},s.a.t("login.certificate-login-authenticate")))),r.a.createElement("form",{action:"#",id:"certificateSchemeForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.certificate-scheme-title"))),r.a.createElement("div",{className:"form-group"},e))}}])&&ae(e.prototype,t),o}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=fe(e);return a=this,!(r=t?(n=fe(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==ie(r)&&"function"!=typeof r?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser,providerList:[]},t.getProviderList(),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser},(function(){t.getProviderList()}))}},{key:"getProviderList",value:function(){var e,t=this;this.state.scheme&&this.state.currentUser&&(e={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{provider_list:!0}},u.a.glewlwydRequest("/auth/scheme/trigger/","POST",e,!0).then((function(e){t.setState({providerList:e})})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("error-api-connect")})})))}},{key:"connectProvider",value:function(e){var t;this.state.scheme&&this.state.currentUser&&(t={scheme_type:this.state.scheme.scheme_type,scheme_name:this.state.scheme.scheme_name,username:this.state.currentUser.username,value:{provider:e,callback_url:window.location.href}},u.a.glewlwydRequest("/auth/scheme/trigger/","POST",t,!0).then((function(e){document.location.href=e.redirect_to})).fail((function(e){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("error-api-connect")})})))}},{key:"render",value:function(){var e=this,t=[];return this.state.providerList.forEach((function(n,a){var o;n.logo_uri?o=r.a.createElement("img",{src:n.logo_uri,alt:n.provider,className:"img-fluid logo-img"}):n.logo_fa&&(o=r.a.createElement("i",{className:n.logo_fa})),t.push(r.a.createElement("div",{key:a},r.a.createElement("hr",null),r.a.createElement("div",{className:"row"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.connectProvider(n.provider)}},o,r.a.createElement("span",{className:"btn-icon-right"},s.a.t("login.oauth2-connect",{provider:n.provider}))))))})),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("h5",null,s.a.t("login.oauth2-title"))),r.a.createElement("div",{className:"form-group"},t))}}])&&le(e.prototype,t),o}();function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ye=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=ge(e);return a=this,!(r=t?(n=ge(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==pe(r)&&"function"!=typeof r?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,currentUser:e.currentUser},t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,currentUser:e.currentUser})}},{key:"render",value:function(){return"mock"===this.state.scheme.scheme_type?r.a.createElement(C,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"email"===this.state.scheme.scheme_type?r.a.createElement(G,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"webauthn"===this.state.scheme.scheme_type?r.a.createElement(F,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"otp"===this.state.scheme.scheme_type?r.a.createElement(H,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"retype-password"===this.state.scheme.scheme_type||"http"===this.state.scheme.scheme_type?r.a.createElement(te,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"certificate"===this.state.scheme.scheme_type?r.a.createElement(se,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):"oauth2"===this.state.scheme.scheme_type?r.a.createElement(me,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}):""}}])&&he(e.prototype,t),o}();function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ne=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=Se(e);return a=this,!(r=t?(n=Se(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==be(r)&&"function"!=typeof r?Ee(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,scheme:e.scheme,schemeListRequired:e.schemeListRequired,client:e.client,currentUser:e.currentUser,canContinue:!e.scheme,show:e.show},t.handleSelectScheme=t.handleSelectScheme.bind(Ee(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,scheme:e.scheme,schemeListRequired:e.schemeListRequired,client:e.client,currentUser:e.currentUser,canContinue:!e.scheme,show:e.show})}},{key:"handleSelectScheme",value:function(e,t){e.preventDefault(),this.setState({scheme:t})}},{key:"render",value:function(){var e=this;if(this.state.canContinue){var t=this.state.client?s.a.t("login.connect-to",{client:this.state.client.name||this.state.client.client_id}):s.a.t("login.connection");return r.a.createElement("div",null,r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-12 "},r.a.createElement("h3",null,t))),r.a.createElement("hr",null),r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.wish-message")))))}var n="",a="",o=[];return this.state.scheme&&(n=r.a.createElement(ye,{config:this.state.config,scheme:this.state.scheme,currentUser:this.state.currentUser}),a=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null)))),this.state.schemeListRequired&&this.state.schemeListRequired.forEach((function(t,n){o.push(r.a.createElement("a",{className:"dropdown-item",key:n,href:"#",onClick:function(n){return e.handleSelectScheme(n,t)}},t.scheme_display_name))})),r.a.createElement("div",null,n,a,r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-primary dropdown-toggle",type:"button",id:"selectScheme","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-user-lock btn-icon"}),s.a.t("login.login-choose-scheme")),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"selectScheme"},o)))}}])&&ve(e.prototype,t),o}();function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=Oe(e);return a=this,!(r=t?(n=Oe(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==_e(r)&&"function"!=typeof r?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,scheme:e.scheme,schemeListRequired:e.schemeListRequired,showGrant:e.showGrant,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable},f.a.subscribe("Body",(function(e){})),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,currentUser:e.currentUser,client:e.client,scope:e.scope,scheme:e.scheme,schemeListRequired:e.schemeListRequired,showGrant:e.showGrant,infoSomeScopeUnavailable:e.infoSomeScopeUnavailable})}},{key:"render",value:function(){var e,t=this.state.showGrant?r.a.createElement("div",{id:"carouselBody",className:"carousel slide","data-ride":"carousel"},r.a.createElement("div",{className:"carousel-inner"},r.a.createElement("div",{className:"carousel-item"+(this.state.showGrant?" active":"")},r.a.createElement(_,{config:this.state.config,currentUser:this.state.currentUser,client:this.state.client,scope:this.state.scope,infoSomeScopeUnavailable:this.state.infoSomeScopeUnavailable})))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(Ne,{config:this.state.config,currentUser:this.state.currentUser,scheme:this.state.scheme,schemeListRequired:this.state.schemeListRequired,client:this.state.client}))),n=this.state.config.profilePicture&&this.state.currentUser[this.state.config.profilePicture.property]?(e=this.state.currentUser[this.state.config.profilePicture.property],Array.isArray(e)&&(e=e[0]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("img",{className:"btn-icon-right img-medium",src:"data:"+this.state.config.profilePicture.type+";base64,"+e,alt:this.state.config.profilePicture.property})))):r.a.createElement("div",{className:"glwd-profile-user-picto-large"},r.a.createElement("i",{className:"fas fa-user"}));return r.a.createElement("div",null,n,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("h4",null,s.a.t("login.hello",{name:this.state.currentUser.name||this.state.currentUser.username})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),t)}}])&&ke(e.prototype,t),o}();function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=xe(e);return a=this,!(r=t?(n=xe(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==Re(r)&&"function"!=typeof r?Ae(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={username:e.username,password:"",config:e.config,currentUser:e.currentUser},t.handleChangeUsername=t.handleChangeUsername.bind(Ae(t)),t.handleChangePassword=t.handleChangePassword.bind(Ae(t)),t.validateLogin=t.validateLogin.bind(Ae(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({username:e.username,password:"",config:e.config,currentUser:e.currentUser})}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"validateLogin",value:function(e){var t;e.preventDefault(),this.state.username&&this.state.password&&(t={username:this.state.username,password:this.state.password},u.a.glewlwydRequest("/auth/","POST",t).then((function(){f.a.sendMessage("App",{type:"loginSuccess"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})})))}},{key:"render",value:function(){var e=this,t=this.state.currentUser?r.a.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",disabled:!0,value:this.state.currentUser.username}):r.a.createElement("input",{type:"text",className:"form-control",name:"username",id:"username",required:"",placeholder:s.a.t("login.login-placeholder"),value:this.state.username,onChange:this.handleChangeUsername,autoFocus:!0});return r.a.createElement("form",{action:"#",id:"passwordForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h4",null,s.a.t("login.enter-login-password"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},s.a.t("login.login"))),t)),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"password"},s.a.t("login.password"))),r.a.createElement("input",{type:"password",className:"form-control",name:"password",id:"password",required:"",placeholder:s.a.t("login.password-placeholder"),value:this.state.password,onChange:this.handleChangePassword,autoFocus:!!this.state.currentUser}))),r.a.createElement("button",{type:"submit",name:"loginbut",id:"loginbut",className:"btn btn-primary",onClick:function(t){return e.validateLogin(t)},title:s.a.t("login.sign-in-title")},s.a.t("login.btn-ok")))}}])&&Ce(e.prototype,t),o}();function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ve=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=De(e);return a=this,!(r=t?(n=De(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==Le(r)&&"function"!=typeof r?qe(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,username:e.username,usernameValidated:!1,scheme:e.scheme},t.handleChangeUsername=t.handleChangeUsername.bind(qe(t)),t.validateUsername=t.validateUsername.bind(qe(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,username:e.username,scheme:e.scheme})}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"validateUsername",value:function(e){e.preventDefault(),this.state.username&&this.setState({usernameValidated:!0})}},{key:"render",value:function(){var e,t,n=this;if(this.state.usernameValidated){var a=!1;return this.state.config.sessionSchemes.forEach((function(e){e.scheme_name===n.state.scheme&&(a="mock"===e.scheme_type?r.a.createElement(C,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):"email"===e.scheme_type?r.a.createElement(G,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):"webauthn"===e.scheme_type?r.a.createElement(F,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):"otp"===e.scheme_type?r.a.createElement(H,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):"retype-password"===e.scheme_type||"http"===e.scheme_type?r.a.createElement(te,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):"certificate"===e.scheme_type?r.a.createElement(se,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):"oauth2"===e.scheme_type?r.a.createElement(me,{config:n.state.config,scheme:e,currentUser:{username:n.state.username}}):r.a.createElement("div",null,"No can do"))})),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("h4",null,s.a.t("login.welcome-login",{username:this.state.username}))),r.a.createElement("div",{className:"form-group"},a),r.a.createElement("div",{className:"form-group"}))}return r.a.createElement("form",{action:"#",id:"passwordForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("h4",null,s.a.t("login.enter-login"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},s.a.t("login.login"))),r.a.createElement("input",(!0,(t="autoFocus")in(e={type:"text",className:"form-control",name:"username",id:"username",autoFocus:!0,required:"",placeholder:s.a.t("login.login-placeholder"),value:this.state.username,onChange:this.handleChangeUsername})?Object.defineProperty(e,t,{value:!0,enumerable:!0,configurable:!0,writable:!0}):e[t]=!0,e)))),r.a.createElement("button",{type:"submit",name:"usernamebut",id:"usernamebut",className:"btn btn-primary",onClick:function(e){return n.validateUsername(e)},title:s.a.t("login.sign-in-title")},s.a.t("login.btn-ok")))}}])&&Ge(e.prototype,t),o}();function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=Je(e);return a=this,!(r=t?(n=Je(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==Ie(r)&&"function"!=typeof r?Be(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]},t.handleBack=t.handleBack.bind(Be(t)),t.handleToggleGrantScope=t.handleToggleGrantScope.bind(Be(t)),t.handleNewAccount=t.handleNewAccount.bind(Be(t)),t.handleLogoutAccount=t.handleLogoutAccount.bind(Be(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]})}},{key:"handleBack",value:function(){f.a.sendMessage("App",{type:"SelectAccountComplete"})}},{key:"handleToggleGrantScope",value:function(e){var t=this;this.setState({currentUser:e},(function(){return u.a.glewlwydRequest("/auth/","POST",{username:t.state.currentUser.username}).then((function(){f.a.sendMessage("Notification",{type:"success",message:s.a.t("login.select-login",{username:t.state.currentUser.username})})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})}))}))}},{key:"handleNewAccount",value:function(){f.a.sendMessage("App",{type:"NewUser"})}},{key:"handleLogoutAccount",value:function(e){u.a.glewlwydRequest("/auth/?username="+e,"DELETE").then((function(){f.a.sendMessage("App",{type:"InitProfile"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})}))}},{key:"handleLogoutAll",value:function(){u.a.glewlwydRequest("/auth/","DELETE").then((function(){f.a.sendMessage("App",{type:"InitProfile"})})).fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-login")})}))}},{key:"render",value:function(){var e,t=this,n=[],a=-1;return this.state.userList.forEach((function(e,n){e.username===t.state.currentUser.username&&(a=n)})),this.state.userList.forEach((function(o,c){var i,l;e=o.picture?(l=o.picture,r.a.createElement("img",{className:"img-thumb glwd-select-user-picture",src:"data:*;base64,"+l})):r.a.createElement("i",{className:"fas fa-user glwd-select-user-picto"}),i=r.a.createElement("div",{className:"input-group",id:"select-user-"+o.username},r.a.createElement("label",{className:"glwd-select-user-label"},r.a.createElement("div",{className:"col input-group-prepend glwd-select-user-col"},e),r.a.createElement("input",{type:"radio",className:"input-hidden",onChange:function(){return t.handleToggleGrantScope(o)},name:"select-user"}),r.a.createElement("div",{className:"col input-group-append glwd-select-user-username"},r.a.createElement("div",{className:"col btn-icon-left glwd-select-user-username v-align-middle"},o.name||o.username),r.a.createElement("button",{type:"button",disabled:!0,className:"glwd-select-user-hidden-button"},r.a.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z/C/HgAGgwJ/lK3Q6wAAAABJRU5ErkJggg=="}))))),n.push(r.a.createElement("li",{className:"list-group-item"+(a===c?" active":""),key:c},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col glwd-no-padding-right"},i),r.a.createElement("div",{className:"col-auto text-right glwd-no-padding-left"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return t.handleLogoutAccount(o.username)}},s.a.t("login.logout"))))))})),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.select-acount-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("ul",{className:"list-group"},n))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleBack},s.a.t("login.back")),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleNewAccount},s.a.t("login.login-another-new")))),r.a.createElement("div",{className:"col-md-6 text-right"},r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.handleLogoutAll},s.a.t("login.logout-all")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))))}}])&&Fe(e.prototype,t),o}();function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Xe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=Ye(e);return a=this,!(r=t?(n=Ye(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==$e(r)&&"function"!=typeof r?Qe(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]},t.handleLogout=t.handleLogout.bind(Qe(t)),t.handleIgnoreLogout=t.handleIgnoreLogout.bind(Qe(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userList:e.userList||[],currentUser:e.currentUser||[]})}},{key:"handleLogout",value:function(){var e=this;u.a.glewlwydRequest("/auth/","DELETE").fail((function(){f.a.sendMessage("Notification",{type:"danger",message:s.a.t("login.error-delete-session")})})).always((function(){e.state.config.params.callback_url&&(document.location.href=e.state.config.params.callback_url)}))}},{key:"handleIgnoreLogout",value:function(){document.location.href=this.state.config.params.callback_url}},{key:"render",value:function(){var e;return this.state.config.params.callback_url&&(e=r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon-right",onClick:this.handleIgnoreLogout},s.a.t("login.ignore-logout"))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,s.a.t("login.end-session-title")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.end-session-message")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("hr",null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon",onClick:this.handleLogout},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),s.a.t("login.logout")),e)))}}])&&Ke(e.prototype,t),o}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=at(e);return a=this,!(r=t?(n=at(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==Ze(r)&&"function"!=typeof r?nt(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={config:e.config,userCode:""},t.handleValidCode=t.handleValidCode.bind(nt(t)),t.handleChangeUserCode=t.handleChangeUserCode.bind(nt(t)),t}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({config:e.config,userCode:""})}},{key:"handleChangeUserCode",value:function(e){var t=e.target.value.replace(/[\W\s\._\-]+/g,"").toUpperCase();8<t.length&&(t=t.substring(0,8)),4<=t.length&&(t=t.substring(0,4)+"-"+t.substring(4)),this.setState({userCode:t})}},{key:"handleValidCode",value:function(){document.location=this.state.config.params.callback_url+"?code="+this.state.userCode}},{key:"render",value:function(){var e,t;return"deviceComplete"===this.state.config.params.prompt?e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.device-authorization-complete-message")))):"deviceServerError"===this.state.config.params.prompt?e=r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.device-authorization-server-error-message")))):(e="deviceCodeError"===this.state.config.params.prompt?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.device-authorization-message"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},s.a.t("login.device-auth-user-code"))),r.a.createElement("input",{type:"text",maxLength:"9",placeholder:s.a.t("login.device-auth-user-code-ph"),value:this.state.userCode,onChange:this.handleChangeUserCode})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.device-authorization-code-error-message"))))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h4",null,s.a.t("login.device-authorization-message"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("label",{className:"input-group-text",htmlFor:"username"},s.a.t("login.device-auth-user-code"))),r.a.createElement("input",{type:"text",maxLength:"9",placeholder:s.a.t("login.device-auth-user-code-ph"),value:this.state.userCode,onChange:this.handleChangeUserCode})))),t=r.a.createElement("button",{type:"button",className:"btn btn-primary btn-icon",onClick:this.handleValidCode,disabled:this.state.userCode.length<9},r.a.createElement("i",{className:"fas fa-sign-out-alt btn-icon"}),s.a.t("login.btn-ok"))),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h3",null,s.a.t("login.device-authorization-title")))),r.a.createElement("hr",null),e,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},t)))}}])&&et(e.prototype,t),o}();function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}var ft=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(o,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=lt(e);return a=this,!(r=t?(n=lt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==ot(r)&&"function"!=typeof r?it(a):r}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).state={newUser:!1,userList:[],currentUser:!1,config:e.config,loaded:!1,lang:s.a.language,scope:[],mustRegisterScheme:!1,scheme:e.config.params.scheme,schemeListRequired:!1,passwordRequired:!1,client:!1,showGrant:!0,showGrantAsterisk:!1,canContinue:!1,prompt:e.config.params.prompt,refresh_login:e.config.params.refresh_login,forceShowGrant:!1,selectAccount:!1,endSession:!1,deviceAuth:!1,login_hint:e.config.params.login_hint||"",errorScopesUnavailable:!1,infoSomeScopeUnavailable:!1,errorScheme:!1},t.initProfile=t.initProfile.bind(it(t)),t.checkClientScope=t.checkClientScope.bind(it(t)),t.checkScopeScheme=t.checkScopeScheme.bind(it(t)),t.changeLang=t.changeLang.bind(it(t)),t.parseSchemes=t.parseSchemes.bind(it(t)),t.state.config&&t.initProfile(),f.a.subscribe("App",(function(e){"InitProfile"===e.type?t.initProfile():"loginSuccess"===e.type?t.setState({selectAccount:!1,refresh_login:!1,prompt:!1},(function(){t.initProfile()})):"NewUser"===e.type?t.setState({selectAccount:!1,newUser:!0,currentUser:!1,scheme:t.state.config.params.scheme},(function(){})):"GrantComplete"===e.type?t.setState({selectAccount:!1,showGrant:!1,prompt:!1,forceShowGrant:!1},(function(){t.initProfile()})):"SelectAccount"===e.type?t.setState({selectAccount:!0},(function(){t.initProfile()})):"SelectAccountComplete"===e.type?t.setState({selectAccount:!1,prompt:!1},(function(){t.initProfile()})):"ToggleGrant"===e.type?t.setState({showGrant:!t.state.showGrant}):"newUserScheme"===e.type&&t.setState({scheme:e.scheme})})),t}return e=o,(t=[{key:"initProfile",value:function(){var e=this;u.a.glewlwydRequest("/profile_list").then((function(t){var n={};t.length&&(n.currentUser=t[0],n.login_hint=t[0].username),n.userList=t,n.loaded=!0,"login"===e.state.prompt?(n.currentUser=!1,n.newUser=!0):"consent"===e.state.prompt?n.forceShowGrant=!0:"select_account"===e.state.prompt?n.selectAccount=!0:"end_session"===e.state.prompt?(n.endSession=!0,n.newUser=!1,n.currentUser=!1):e.state.prompt&&"device"===e.state.prompt.substring(0,6)?n.deviceAuth=!0:n.newUser=!1,e.setState(n,(function(){e.state.config.params.client_id&&e.state.config.params.scope?e.checkClientScope(e.state.config.params.client_id,e.state.config.params.scope):e.state.config.params.scope?e.checkScopeScheme(e.state.config.params.scope):e.setState({showGrantAsterisk:!1})}))})).fail((function(t){401!=t.status&&f.a.sendMessage("Notification",{type:"warning",message:s.a.t("error-api-connect")}),"device"===e.state.prompt?e.setState({deviceAuth:!0,currentUser:!1,userList:[],loaded:!0}):e.setState({newUser:!0,currentUser:!1,userList:[],loaded:!0})}))}},{key:"checkClientScope",value:function(e,t){var n=this;u.a.glewlwydRequest("/auth/grant/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)).then((function(e){var a,r=[],o={},c=!0,i=!1;e.scope.length?(a=t.split(" ").length>e.scope.length,e.scope.forEach((function(e){"openid"===e.name&&(e.granted=!0),e.granted?("openid"!==e.name&&(c=n.state.forceShowGrant),r.push(e.name),o[e.name]=e):i=!0})),r.length?u.a.glewlwydRequest("/auth/scheme/?scope="+encodeURIComponent(r.join(" "))).then((function(t){n.setState({client:e.client,scope:e.scope,scheme:t,showGrant:c,showGrantAsterisk:i,infoSomeScopeUnavailable:a,errorScopesUnavailable:!1},(function(){n.parseSchemes()}))})).fail((function(e){f.a.sendMessage("Notification",{type:"warning",message:s.a.t("login.error-scheme-scope-api")})})):n.setState({client:e.client,scope:e.scope,showGrant:!0,showGrantAsterisk:!0,errorScopesUnavailable:!1,infoSomeScopeUnavailable:a})):n.setState({errorScopesUnavailable:!0,infoSomeScopeUnavailable:!1})})).fail((function(e){404===e.status?f.a.sendMessage("Notification",{type:"warning",message:s.a.t("login.error-scheme-scope-unavailable")}):f.a.sendMessage("Notification",{type:"warning",message:s.a.t("login.error-grant-api")})}))}},{key:"checkScopeScheme",value:function(e){var t=this;u.a.glewlwydRequest("/auth/scheme/?scope="+e).then((function(e){t.setState({scheme:e,showGrant:!1,showGrantAsterisk:!1},(function(){t.parseSchemes()}))})).fail((function(e){404===e.status?f.a.sendMessage("Notification",{type:"warning",message:s.a.t("login.error-scheme-scope-unavailable")}):f.a.sendMessage("Notification",{type:"warning",message:s.a.t("login.error-scheme-scope-api")})}))}},{key:"parseSchemes",value:function(){var e=!!this.state.config.params.callback_url,t=!1,n=!1,a=!1,r=!1;for(var o in this.state.scheme)if(e){var c=this.state.scheme[o];if(c.available&&c.password_required&&!c.password_authenticated){a=n=!(t=!(e=!1));break}if(!n&&e)for(var s in c.schemes){var i=c.schemes[s],l=!1;n=i;if(i.forEach((function(e){r=!1,e.scheme_authenticated?a=n=!(l=!0):(!a||a.scheme_last_login<e.scheme_last_login)&&e.scheme_registered?a=e:e.scheme_registered||a||(r=!0)})),!l){e=!1;break}}}!t&&this.state.refresh_login&&(t=!0),e&&(a=!1),this.setState({canContinue:e,passwordRequired:t,schemeListRequired:n,scheme:a,errorScheme:!a&&!e,mustRegisterScheme:r})}},{key:"changeLang",value:function(e,t){var n=this;s.a.changeLanguage(t).then((function(){n.setState({lang:t})}))}},{key:"render",value:function(){var e=this;if(this.state.config){var t,n="";this.state.loaded&&(n=this.state.endSession?r.a.createElement(Xe,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser}):this.state.deviceAuth?r.a.createElement(rt,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser}):(this.state.mustRegisterScheme&&!this.state.errorScopesUnavailable?t=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},s.a.t("login.warning-not-registered-scheme")):this.state.errorScheme&&!this.state.errorScopesUnavailable?t=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},s.a.t("login.warning-error-scheme")):this.state.config.params.callback_url||(t=r.a.createElement("div",{className:"alert alert-warning",role:"alert"},s.a.t("login.warning-no-callback-url"))),this.state.errorScopesUnavailable?r.a.createElement("div",{className:"alert alert-danger",role:"alert"},s.a.t("login.error-scope-unavailable")):this.state.newUser||this.state.passwordRequired?this.state.scheme?r.a.createElement(Ve,{config:this.state.config,username:this.state.login_hint,callbackInitProfile:this.initProfile,scheme:this.state.scheme}):r.a.createElement(Te,{config:this.state.config,username:this.state.login_hint,currentUser:this.state.currentUser,callbackInitProfile:this.initProfile}):this.state.selectAccount?r.a.createElement(ze,{config:this.state.config,userList:this.state.userList,currentUser:this.state.currentUser}):r.a.createElement(Pe,{config:this.state.config,currentUser:this.state.currentUser,client:this.state.client,scope:this.state.scope,scheme:this.state.scheme,schemeListRequired:this.state.schemeListRequired,showGrant:this.state.showGrant,infoSomeScopeUnavailable:this.state.infoSomeScopeUnavailable})));var a=[];return this.state.config.lang.forEach((function(t,n){t===s.a.language?a.push(r.a.createElement("a",{className:"dropdown-item active",href:"#",key:n},t)):a.push(r.a.createElement("a",{className:"dropdown-item",href:"#",onClick:function(n){return e.changeLang(n,t)},key:n},t))})),r.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"glwd-container"},r.a.createElement("div",{className:"card center glwd-card",id:"userCard",tabIndex:"-1",role:"dialog"},r.a.createElement("div",{className:"card-header"},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light"},r.a.createElement("a",{className:"navbar-brand",href:"#","data-toggle":"collapse"},r.a.createElement("img",{className:"mr-3",src:"img/logo-login.png",alt:"logo"}),s.a.t("login.menu-title")),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav mr-auto"}),r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownLang","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("i",{className:"fas fa-globe-africa"})),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownLang"},a))))),t,r.a.createElement("div",{className:"card-body"},n),r.a.createElement("div",{className:"card-footer"},r.a.createElement(b,{config:this.state.config,currentUser:this.state.currentUser,userList:this.state.userList,showGrant:this.state.showGrant,showGrantAsterisk:this.state.showGrantAsterisk,newUser:this.state.newUser,newUserScheme:this.state.scheme,canContinue:this.state.canContinue,schemeListRequired:this.state.schemeListRequired,selectAccount:this.state.selectAccount}))),r.a.createElement(m.a,{loggedIn:!0}))}return r.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"glwd-container"},r.a.createElement("div",{className:"card center glwd-card",id:"userCard",tabIndex:"-1",role:"dialog"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h4",null,r.a.createElement("span",{className:"badge badge-danger"},s.a.t("error-api-connect"))))))}}])&&ct(e.prototype,t),o}(),mt={fallbackLng:"en",ns:["translations"],defaultNS:"translations",backend:{loadPath:"locales/{{lng}}/{{ns}}.json"}};ut("ui_locales")&&(mt.lng=ut("ui_locales").split(" ")[0]);try{s.a.use(i.a).use(l.a).init(mt).then((function(){u.a.request("config.json").then((function(e){e.lang||(e.lang=["en","fr","nl"]),u.a.request(e.GlewlwydUrl+"config/").then((function(t){u.a.setConfig(e.GlewlwydUrl+t.api_prefix);var n=Object.assign({params:{scope:ut("scope")||!1,client_id:ut("client_id")||!1,callback_url:ut("callback_url")||!1,scheme:ut("scheme")||e.defaultScheme||!1,prompt:ut("prompt")||!1,refresh_login:!!ut("refresh_login"),login_hint:ut("login_hint")||!1}},e,t);c.a.render(r.a.createElement(ft,{config:n}),document.getElementById("root"))})).fail((function(e){c.a.render(r.a.createElement(ft,{config:!1}),document.getElementById("root"))}))}))}))}catch(e){$("#root").html('<div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i><span class="btn-icon-right">You must use a browser compatible with Glewlwyd SSO</span></div>')}},3:function(e,t,n){"use strict";var a=n(2);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.GlewlwydApiPrefix="",this.GlewlwydApiPrefixSub=""}var t,n;return t=e,(n=[{key:"setConfig",value:function(e){this.GlewlwydApiPrefix=e}},{key:"getConfig",value:function(){return this.GlewlwydApiPrefix}},{key:"setConfigSub",value:function(e){this.GlewlwydApiPrefixSub=e}},{key:"getConfigSub",value:function(){return this.GlewlwydApiPrefixSub}},{key:"request",value:function(e,t,n){var a=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==n&&n;return r&&"GET"!==a?$.ajax({method:a,url:e,data:JSON.stringify(r),contentType:"application/json; charset=utf-8"}):$.ajax({method:a,url:e})}},{key:"glewlwydRequest",value:function(e,t,n,r){var o=1<arguments.length&&void 0!==t?t:"GET",c=2<arguments.length&&void 0!==n&&n,s=3<arguments.length&&void 0!==r&&r;return this.request(this.GlewlwydApiPrefix+e,o,c).fail((function(e){s&&401===e.status&&a.a.sendMessage("App",{type:"loggedIn",message:!1})}))}},{key:"glewlwydRequestSub",value:function(e,t,n){var a=1<arguments.length&&void 0!==t?t:"GET",r=2<arguments.length&&void 0!==n&&n;return this.request(this.GlewlwydApiPrefixSub+e,a,r)}}])&&r(t.prototype,n),e}());t.a=o},4:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(2);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(f,a.Component);var e,t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a,r,o=u(e);return a=this,!(r=t?(n=u(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments))||"object"!==c(r)&&"function"!=typeof r?l(a):r}}(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=n.call(this,e)).state={message:[],counter:0,loggedIn:e.loggedIn},o.a.subscribe("Notification",(function(e){var n;e.type&&((n=t.state.message).push({type:e.type,message:e.message,id:t.state.counter}),t.setState({message:n,counter:t.state.counter+1},(function(){t.timeoutClose(t.state.counter-1)})))})),t.close=t.close.bind(l(t)),t.timeoutClose=t.timeoutClose.bind(l(t)),t}return e=f,(t=[{key:"componentWillReceiveProps",value:function(e){this.setState({loggedIn:e.loggedIn})}},{key:"timeoutClose",value:function(e){var t=this;setTimeout((function(){t.close(e)}),5e3)}},{key:"close",value:function(e){var t=this,n=this.state.message;n.forEach((function(a,r){a.id===e&&(n.splice(r,1),t.setState({message:n}))}))}},{key:"render",value:function(){var e=this,t=[];return this.state.loggedIn&&this.state.message.forEach((function(n,a){var o="success"===n.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-success btn-icon"},r.a.createElement("i",{className:"fas fa-check-circle"})),"Glewlwyd"):"danger"===n.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-danger btn-icon"},r.a.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):"warning"===n.type?r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-warning btn-icon"},r.a.createElement("i",{className:"fas fa-exclamation-circle"})),"Glewlwyd"):r.a.createElement("strong",{className:"mr-auto"},r.a.createElement("span",{className:"badge badge-info btn-icon"},r.a.createElement("i",{className:"fas fa-info-circle"})),"Glewlwyd");t.push(r.a.createElement("div",{className:"toast-container",style:{top:85+90*a,right:5},key:a},r.a.createElement("div",{className:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},r.a.createElement("div",{className:"toast-header"},o,r.a.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close",onClick:function(){return e.close(n.id)}},r.a.createElement("span",{"aria-hidden":"true"},"×"))),r.a.createElement("div",{className:"toast-body"},n.message))))})),r.a.createElement("div",null,t)}}])&&s(e.prototype,t),f}();t.a=f}})}));